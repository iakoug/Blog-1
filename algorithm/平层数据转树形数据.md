```js
let list = [
  {
    id: 1,
    name: '部门1',
    pid: 0,
  },
  {
    id: 2,
    name: '部门2',
    pid: 1,
  },
  {
    id: 3,
    name: '部门3',
    pid: 1,
  },
  {
    id: 4,
    name: '部门4',
    pid: 3,
  },
];

function toTree(tempList) {
  const result = [];
  const itemMap = {};
  // 组装字典
  for (const item of tempList) {
    itemMap[item.id] = {
      ...item,
      children: [],
    };
  }

  for (const item of tempList) {
    const id = item.id;
    const pid = item.pid;

    if (!itemMap[pid]) {
      result.push(itemMap[id]); // 如果该节点对应的父节点不存在，则表明其是根节点
    } else {
      itemMap[pid].children.push(itemMap[id]); // 找到其父节点，将当前节点push到其父节点的children中
    }
  }
  console.log(JSON.stringify(result));
  return result;
}

toTree(list);
```