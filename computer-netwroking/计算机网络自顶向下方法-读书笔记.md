#  计算机网络自顶向下方法

## 1. 计算机网络和因特网

### 1.1 什么是因特网

#### 1.1.1 具体构成描述

从因特网的组成部件角度出发：

由不同的主机（端系统）所组成的网络叫做`因特网`。其中`主机`不仅仅是桌面PC、服务器等，也可以是一些非传统设备，如：电视、游戏机、家用电器等。

端系统通过`通信链路(communication link)`和`分组交换机(packet switch)`连接到一起。

* 通信链路：不同类型的`通信链路`由不同类型的物理媒体组成，如：同轴电缆、光纤和无线电频谱。其不同`通信链路`有不同的传输速率，其以比特/秒(bit/s，或bps)度量

* 分组：当一个端系统向另外一个端系统发送数据前，发送端系统需要先将数据进行分段，并为每段加上首部字节，由此组成的信息包，叫做分组。

* 分组交换机：分组交换机从它的一条`入通信链路`接收分组，并从另外一条`出通信链路`转发该分组。常见的有`路由器(router)`和`链路层交换机(link-layer switch)`。路由器工作于`接入网`（待补充），链路层交换机常用于`网络核心`（待补充）。

端系统通过`因特网服务提供商(Internet Service Provider, ISP)`接入因特网。（ISP包括住宅区ISP、公司ISP、智能手机和其他设备提供移动接入的蜂窝数据ISP等）。每个ISP自身就是一个由多台分组交换机和多段通信链路组成的网络。各ISP为端系统提供了不同的接入方式，如：住宅宽带接入、高速局域网和移动无线接入等。

#### 1.1.2 服务描述

从因特网为应用程序提供服务的基础设施出发：

因特网还包括移动智能手机和平板电脑应用程序，如：即时通讯、来自云的音乐、电影、多人游戏等。这些应用程序涉及到多个相互交换数据的端系统，即`分布式应用程序（distributed application）`。

要实现不同端系统上应用程序的交互，**起始端系统的应用程序**需要通过`套接字接口（socket interface）`请求**因特网基础设施**向**目的端系统上的应用程序**交付数据。该接口是一套发送程序必须遵循的规则集合，因特网才能将数据交付到目的地。（比如：张三洗完信后如果直接扔出窗外，则无法达到李四那里。需要写上李四的邮政编码，联系方式，姓名等，再交给邮政公司，由邮政对其信息识别成功后，转交给李四）

#### 1.1.3 网络协议

协议定义了两个或多个通信实体之间交换的`报文格式`和`次序`，以及在报文传输/接收其他事件方面所采取的`动作`

#### 1.2 网络结构

互联网按组成类型由`网络边缘`、`网络核心`和`接入网`组成。

### 1.2.1 网络边缘

由端系统（主机）构成，主机又分为客户端(client)和服务器(server)。存储应用程序。

### 1.2.2 接入网

有线或无线的通信链路，用于将端系统连接到网络核心。实际上，它是将端系统物理连接到`边缘路由器`（端系统到任何其他远程端系统路径上的第一台路由器）。

宽带住宅接入有两种最流行的类型数字户(Digital Subscriber Line,DSL)和电缆。

* DSL:住户通过电话线接入本地电话公司处获得DSL因特网接入，位于电话公司的本地中心局交换数据。

![DSL图](https://raw.githubusercontent.com/kerwin-ly/Blog/master/assets/imgs/internet/dsl.png)

* 电缆接入：利用有线电视公司有线电视基础设施接入网络

* 光纤到户：最简单的光纤分布网络为，从本地中心局到每户设置一根光纤。更为一般的是 从中心局岀来的每根光纤实际上由许多家庭共享，直到对接近这些家庭 位置，才为每户分成一个独享光纤。

除了以上接入方式外，还有以太网和wifi的形式接入。

### 1.2.3 网络核心

互连的路由器，用于数据交换。

通过网络链路和交换机移动数据有两种基本方法：`电路交换(circuit switching)`和`分组交换(packet switching)`。

* **电路交换**：在发送方发送信息前，该网络必须在发送方和接受方之间建立一条连接。其建立连接的时候，预留了端系统之间沿路通信所需要的资源，也就是预留了其带宽，这使得让发送方能够以恒定速率向接收方发送数据。（如：电话网络）

* **分组交换**：端系统发送数据前，将数据拆分为一个个小的数据块，即：分组。其通常通过`存储转发传输`方式传输数据，即在数据的传输中，经过每个交换节点时，需要将其分组的所有比特都接收完后，才能往通信链路继续传输。

* **电路交换和分组交换的区别**：

**电路交换：**

1.按照`频分复用`、`时分复用`和`波分复用`的区别，将链路划分为一个个频段、时隙和波段，用户仅仅享用其中一段。不享用整个链路的资源。

2.通信前，需要先建立连接

3.独享链路的一段资源，传输稳定，速率恒定

**分组交换：**

1.传输前，将资源先分解成多个分组。传输方式分为虚电路和数据报。数据报方式传输每个分组时，每个分组需保留目标主机的完整路径，路由器不维护主机之间的通信状态。采用虚电路方式，在通信前需要在各个交换节点和目标主机间需建立虚电路，并维护之间的通信状态。

2.经过交换节点前，需要将整个分组接收完后，才能在通信链路上继续传输

3.享用整个链路的资源，但与其他用户共享，速率不稳定

### 1.2.4 ISP（Internet Service Provider）

`ISP`提供了将端系统接入到因特网的能力。今天的因特网实际是一个**网络的网络**。其由十多个第一层ISP和数十万个较低层的ISP组成。

其中如果位于相同等级结构层次的`ISP`能够实现对等(peer)，则其可以直接将他们的网络连接到一起，无需通过上层的`中间ISP`转发。这种模式通过`因特网交换点(Internet Exchange Point, IXP)`实现，`IXP`是一个汇合点，多个`ISP`在这里一起对等。

`ICP(Internet Content Provider)`如谷歌等，它们提供了端系统上的应用程序。其也可以通过建立`数据中心（Data Center）`和专线网络的方式，来绕过部分`ISP`。通过专线网络，让上层`ISP`和最底层的`接入ISP`直接互联。

![ISP](https://raw.githubusercontent.com/kerwin-ly/Blog/master/assets/imgs/internet/isp.png)